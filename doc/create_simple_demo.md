# NPC ç´ æåº«è™•ç†æˆæœ

## ğŸ¯ è™•ç†å®Œæˆçš„å…§å®¹

### 1. åˆ†æäº†NPCç´ æåœ–ç‰‡
- ç´ æåœ–ç‰‡: `static/assets/tilesets/npc.png` (1024x1024)
- ç¶²æ ¼çµæ§‹: 13x11 = 143å€‹è§’è‰²æ¡†æ¶
- æ¯å€‹æ¡†æ¶å¤§å°: 78x93 åƒç´ 

### 2. å‰µå»ºäº†NPCç´ æè™•ç†å·¥å…·
- ä½ç½®: `tools/sprite_processor.py`
- åŠŸèƒ½: 
  - åˆ†æsprite sheetçµæ§‹
  - å‰µå»ºatlasé…ç½®æ–‡ä»¶
  - ç”Ÿæˆè§’è‰²å®šç¾©æ–‡ä»¶
  - æ›´æ–°NPCæ•¸æ“šæ ¼å¼

### 3. ç”Ÿæˆçš„é…ç½®æ–‡ä»¶

#### Atlasé…ç½® (`static/assets/data/npc_atlas.json`)
- å®šç¾©äº†143å€‹è§’è‰²æ¡†æ¶çš„ä½ç½®ä¿¡æ¯
- æ ¼å¼ç¬¦åˆPhaser.js atlasæ¨™æº–
- æ¯å€‹æ¡†æ¶éƒ½æœ‰æº–ç¢ºçš„åº§æ¨™å’Œå°ºå¯¸

#### è§’è‰²å®šç¾© (`static/assets/data/npc_characters.json`)
```json
{
  "business_suit_male_1": {
    "description": "ç”·æ€§å•†å‹™å¥—è£è§’è‰² 1",
    "frames": {
      "idle": [0, 1, 2],
      "walking": [13, 14, 15, 16],
      "sitting": [26, 27],
      "talking": [39, 40, 41]
    },
    "recommended_for": ["ç¶“ç†", "ä¸»ç®¡", "å®¢æˆ¶"]
  },
  "business_suit_female_1": {
    "description": "å¥³æ€§å•†å‹™å¥—è£è§’è‰² 1",
    "frames": {
      "idle": [3, 4, 5],
      "walking": [17, 18, 19, 20],
      "sitting": [28, 29],
      "talking": [42, 43, 44]
    },
    "recommended_for": ["ç¶“ç†", "è¨­è¨ˆå¸«", "å°ˆå“¡"]
  }
  // ... æ›´å¤šè§’è‰²é¡å‹
}
```

#### æ›´æ–°çš„NPCæ•¸æ“š (`static/assets/data/npcs_updated.json`)
```json
{
  "npcs": [
    {
      "id": "npc_001",
      "name": "æç¶“ç†",
      "position": "ç”¢å“ç¶“ç†",
      "personality": "åš´è¬¹è² è²¬",
      "x": 300,
      "y": 400,
      "character_type": "business_suit_male_1",
      "current_frame": "idle",
      "dialogue": "æ­¡è¿ä¾†åˆ°æˆ‘å€‘å…¬å¸ï¼æœ‰ä»€éº¼å¯ä»¥å¹«åŠ©ä½ çš„å—ï¼Ÿ",
      "npcType": "desk"
    }
    // ... æ›´å¤šNPC
  ]
}
```

### 4. æ›´æ–°çš„ä»£ç¢¼çµæ§‹

#### NPCTypes.ts - æ–°å¢ä»‹é¢å®šç¾©
- `NPCCharacterDefinition`: è§’è‰²å‹•ç•«å¹€å®šç¾©
- `NPCAtlasFrame`: Atlasæ¡†æ¶çµæ§‹å®šç¾©
- æ›´æ–° `NPCData` æ”¯æ´æ–°çš„è§’è‰²ç³»çµ±

#### NPC.ts - å¢å¼·çš„NPCé¡
- æ”¯æ´å‹•æ…‹è§’è‰²é¡å‹è¼‰å…¥
- è‡ªå‹•å‹•ç•«æ’­æ”¾ (idle, walking, sitting, talking)
- æ»‘é¼ äº’å‹•æ™‚åˆ‡æ›å‹•ç•«ç‹€æ…‹
- å›é€€ç³»çµ±æ”¯æ´èˆŠçš„sprite sheet

#### NPCManager.ts - æ”¹é€²çš„ç®¡ç†å™¨
- æ”¯æ´æ–°èˆŠæ•¸æ“šæ ¼å¼
- è‡ªå‹•è½‰æ›legacy spriteåˆ°æ–°è§’è‰²é¡å‹
- å®¹éŒ¯è™•ç†å’Œå‚™ç”¨æ•¸æ“š

#### Game.ts - å ´æ™¯æ›´æ–°
- æ”¯æ´atlasç´‹ç†è¼‰å…¥
- ä¿ç•™å‚™ç”¨çš„spritesheetç³»çµ±
- å„ªé›…çš„éŒ¯èª¤è™•ç†å’Œå›é€€æ©Ÿåˆ¶

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. é‹è¡Œspriteè™•ç†å·¥å…·
```bash
cd tools
python3 sprite_processor.py
```

### 2. åœ¨Phaserä¸­è¼‰å…¥æ–°çš„NPCç³»çµ±
```typescript
// åœ¨Game.tsçš„preloadä¸­
this.load.atlas('npc-atlas', 'tilesets/npc.png', 'data/npc_atlas.json');

// å‰µå»ºNPC
const npcManager = new NPCManager(this);
await npcManager.loadNPCData();
npcManager.createNPCs();
```

### 3. NPCäº’å‹•åŠŸèƒ½
- æ»‘é¼ æ‡¸åœ: åˆ‡æ›åˆ°talkingå‹•ç•«
- é»æ“Š: é¡¯ç¤ºå°è©±ä¸¦æ’­æ”¾talkingå‹•ç•«
- è‡ªå‹•: å¹³æ™‚ä¿æŒidleå‹•ç•«ç‹€æ…‹

## ğŸ¨ è§’è‰²ç´ æåº«ç‰¹é»

### æ”¯æ´çš„è§’è‰²é¡å‹
1. **business_suit_male_1** - ç”·æ€§å•†å‹™å¥—è£
2. **business_suit_female_1** - å¥³æ€§å•†å‹™å¥—è£  
3. **casual_male_1** - ç”·æ€§ä¼‘é–’æœè£
4. **casual_female_1** - å¥³æ€§ä¼‘é–’æœè£

### æ”¯æ´çš„å‹•ç•«ç‹€æ…‹
- **idle**: éœæ­¢å¾…æ©Ÿå‹•ç•«
- **walking**: è¡Œèµ°å‹•ç•«
- **sitting**: åè‘—å‹•ç•«  
- **talking**: èªªè©±å‹•ç•«

### è‡ªå‹•åŒ–åŠŸèƒ½
- æ¡†æ¶ä½ç½®è‡ªå‹•è¨ˆç®—
- å‹•ç•«å¾ªç’°æ’­æ”¾
- éŒ¯èª¤å®¹éŒ¯è™•ç†
- å‘å¾Œå…¼å®¹èˆŠç³»çµ±

## ğŸ”§ æŠ€è¡“ç‰¹é»

1. **æ¨¡çµ„åŒ–è¨­è¨ˆ**: æ¯å€‹çµ„ä»¶éƒ½å¯ä»¥ç¨ç«‹ä½¿ç”¨
2. **å®¹éŒ¯è™•ç†**: è‡ªå‹•å›é€€åˆ°å‚™ç”¨ç³»çµ±
3. **æ•ˆèƒ½å„ªåŒ–**: ä½¿ç”¨atlasæ¸›å°‘ç´‹ç†åˆ‡æ›
4. **æ˜“æ–¼æ“´å±•**: è¼•é¬†æ·»åŠ æ–°è§’è‰²é¡å‹å’Œå‹•ç•«
5. **é–‹ç™¼å‹å¥½**: è©³ç´°çš„æ—¥èªŒå’ŒéŒ¯èª¤ä¿¡æ¯

é€™å€‹NPCç´ æåº«ç³»çµ±ç¾åœ¨å·²ç¶“æº–å‚™å¥½å¯ä»¥åœ¨è¾¦å…¬å®¤éŠæˆ²ä¸­ä½¿ç”¨ï¼Œæä¾›è±å¯Œçš„è§’è‰²å‹•ç•«å’Œäº’å‹•åŠŸèƒ½ï¼